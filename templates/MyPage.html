{% extends "Main.html" %} {% block title %}ë§ˆì´í˜ì´ì§€{% endblock %} {% block
content %}

<!-- ì˜¤ëŠ˜ ê³µë¶€ ì‹œê°„ ì•ˆë‚´ -->
<div class="box has-text-centered">
  <p class="is-size-4">
    <strong>{{ username }}</strong>ë‹˜ì˜ ì˜¤ëŠ˜ì˜ ê³µë¶€ì‹œê°„ì€
    <strong id="today-time"
      >{{ today_hours }}ì‹œê°„ {{ today_minutes }}ë¶„ {{ today_seconds_html
      }}ì´ˆ</strong
    >
    ì…ë‹ˆë‹¤.
  </p>
</div>
<!-- ì„œë²„ì—ì„œ ì…ì‹¤ ì‹œê°ì„ Unix íƒ€ì„ìŠ¤íƒ¬í”„ë¡œ ì „ë‹¬ -->
<div
  id="enter-time"
  data-timestamp="{{ enter_time_timestamp or '' }}"
  style="display: none"
></div>

<!-- ì£¼ê°„ ëª©í‘œ & ì§„í–‰ë¥  -->
<div class="box">
  <p class="mb-3">ì´ ì£¼ì˜ ëª©í‘œ: <strong>{{ weekly_goal }}</strong> ì‹œê°„</p>

  <!-- ì§„í–‰ë¥  ë°” -->
  <progress
    class="progress is-success"
    value="{{ progress_percent }}"
    max="100"
  >
    {{ progress_percent }}%
  </progress>

  <div class="has-text-centered mt-2">
    ëª©í‘œê¹Œì§€ <strong>{{ progress_percent }}%</strong> ë‹¬ì„±í•˜ì…¨ìŠµë‹ˆë‹¤!! ğŸ‘Š
    <br />
    ì´ë²ˆ ì£¼<strong>â°{{week_study_hour}} ì‹œê°„ {{week_study_minute}}ë¶„</strong>
    ê³µë¶€í•˜ì…¨ìŠµë‹ˆë‹¤.
  </div>
</div>

<!-- ëª©í‘œ ì„¤ì • & ìˆœìœ„ -->
<div class="columns mt-4">
  <div class="column">
    <div class="box has-text-left">
      í˜„ì¬ ì •ê¸€ <strong>{{ rank }}ë“±</strong> ì…ë‹ˆë‹¤
    </div>
  </div>
  <div class="column has-text-right">
    <a href="/goal" class="button is-link">ì´ë²ˆ ì£¼ ëª©í‘œ ì„¤ì •</a>
  </div>
</div>

<script>
  const enterTimeElement = document.getElementById("enter-time");
  const timestamp = enterTimeElement
    ? enterTimeElement.dataset.timestamp
    : null;
  if (timestamp && parseInt(timestamp) > 0) {
    //timestamp ê°’ì´ ì¡´ì¬í•˜ëŠ”ê°€ && ì–‘ì˜ ì •ìˆ˜ì¸ê°€
    // timestampëŠ” ì´ˆ ë‹¨ìœ„ì´ë¯€ë¡œ ë°€ë¦¬ì´ˆë¡œ ë³€í™˜
    const enterTimestamp = parseInt(timestamp) * 1000;
    function updateStudyTime() {
      const now = Date.now();
      const elapsed = now - enterTimestamp;
      const hours = Math.floor(elapsed / (1000 * 60 * 60));
      const minutes = Math.floor((elapsed % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((elapsed % (1000 * 60)) / 1000);
      document.getElementById(
        "today-time"
      ).textContent = `${hours}ì‹œê°„ ${minutes}ë¶„ ${seconds}ì´ˆ`;
    }
    //1ì´ˆë§ˆë‹¤ updateStudyTime() í•¨ìˆ˜ë¥¼ ì‹¤í–‰
    setInterval(updateStudyTime, 1000);
    //í˜ì´ì§€ ë¡œë”© ì§í›„ ë°”ë¡œ í•œ ë²ˆ ì‹¤í–‰í•´ì„œ í‘œì‹œê°’ ì´ˆê¸°í™”
    updateStudyTime();
  }
</script>
{% endblock %}
